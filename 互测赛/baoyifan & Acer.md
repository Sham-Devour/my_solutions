## T1 减法

签到。

解法很多。

示例：

$1^\circ$

转化操作，差分后：

1. $b[1]--,b[k]++(2\le k\le n+1)$

2. $b[k]--,b[n+1]++(1\le k\le n)$

$b[1]-b[n]=0$

对于：

$b[k]>0->$ 操作二

$b[k]<0->$ 操作一

$check：b[1]<0?NO:YES$

## T2 借钱

送分题。

### 题意

给你一个有向图，点有点权，从任意一点出发，求能经过的最大点权。

### 分析

考虑直接暴力搜索，发现如果出现 $A->B,B->C,C->A$ 的情况会直接暴毙，那么有没有什么不让他暴毙的的方法呢？

$tarjan$ 强联通分量，缩个点不就完了嘛。。。

缩点后的新图，不存在任意点之间两两互相可达，所以从任意一点开始，暴力 $dfs$ 到不能走为止，很显然，如果对于 $x$ 到 $y$，考虑从 $x$ 开始计算 $dfs$ 的答案，假设 $x$ 下一步可以到达 $y$，则 $x$ 的贡献为自身权值 $+y$ 的贡献，但如果 $y$ 的编号比 $x$ 小，则 $y$ 算了自身贡献后，在算 $x$ 时，又再次需要计算 $y$ 的贡献，时间复杂度起飞。所以当计算 $i$ 的时候，记录 $i$ 的贡献 $dp[i]$，$dp[i]=max\{dp[son[i]]\}+w[i]$

在缩点后的新图上跑记忆化搜索，时间复杂度 $O(n+m)$

## T3 产生关系

简单送分题。

#### 离线

重点：预处理树的形态。

$tip：BZOJ$ 大融合

#### 在线

$1^\circ LCT$

$?$

不会。

$?$

##### $2^\circ$ 分块
<details>
  <summary>Hint 1:</summary>
并查集不支持删除，怎么办?
</details>

<details>
  <summary>Hint 2:</summary>
删除操作只是假设，不执行，怎么办?
</details>

<details>
  <summary>Hint 3:</summary>
BruteForce
</details>

考虑暴力。

>  $1^\circ$ 不支持删除就不删，用一个 $vector$ 存当前所有添加操作，询问时添加除询问边外所有边，需要回退。
>
>  $2^\circ$ 不支持删除还是就不删，用 $n$ 个存图当前所有$n$条边除去一条边的形状，询问时在对应图里直接查找。

**重点**：前文提醒：**简单** - **送分** 题。

结合一下。

每 $S$ 个添加分一块，建一个新图，图中存当前除这 $S$ 个边的边组成的路径压缩并查集维护的树。

询问在这条边对应建的图里临时并查集(按秩合并)一下，添加除此边的其他边。

并查集回退一下。

$O(n\sqrt nlog \sqrt n)$


## T4 奶盖拌饭

### 题意

给定一个图，求每条边的最大权值（当讨论一条边时，其他边边权不变），使其一定在所有可能的最小生成树中

### 分析

如果直接在求最小生成树山做文章，思考一会儿后，发现好像不行。
于是假设已知最小生成树和该图，考虑图中每条边是树边还是非树边。

- 若 $e(x,y)$ 为非树边（不在最小生成树上的边），那么对于该最小生成树，再添加 $e(x,y)$ 后，构成的环上的最大边一定是 $e(x,y)$，但如果 $e(x,y)$ 小于该环上的最大边，则可以保证被选入最小生成树中，所以 $e(x,y)$ 的权值应为 $x$ 到 $y$ 路径上的最大值减 1
- 若 $e(x,y)$ 为树边（在最小生成树上的边），那么对于任意一条非树边 $e(u,v)$，若满足 $u$ 到 $v$ 的树上路径经过 $e(x,y)$
  那么，添加 $e(a,b)$ 后所构成的环上的最大边一定是 $e(a,b)$（上面也说过了），那么要保证被选入最小生成树中，$e(x,y)$ 的权值应当等于所有满足条件的 $e(a,b)$ 的最小值减 1

然后我们需要想办法处理出每个点的答案。

对于情况 1（非树边），求的是路径最大值，树上倍增基本操作，不会的同学可以上网自学（大家这么强，应该没有不会的吧）。

对于情况 2（树边），考虑并查集，对非树边有小到大依次处理，标记到的边为最小值，处理完后，用并查集合并起来，即每个点的父亲执指向祖先中最近未处理的点（边），因为对于两次非树边的更新，它可能会是两条线段的覆盖，对于交集区域，需要同时满足小于 $K1,K2$，而已经按照非树边排序，则 $K1<K2$，那么在更新第二条边的时候，可以将这一段给压缩起来，不再更新。

时间复杂度 $O(nlogn)$

其实对于这两种情况，用树链剖分（HLD），LCT 也可以解决。
